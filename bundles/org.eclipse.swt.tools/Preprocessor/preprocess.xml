<?xml version="1.0" encoding="UTF-8"?>

<!-- This file defines tasks for preprocessing the SWT java source files  -->

<project name="org.eclipse.swt.tools" default="swt.64" basedir="..">

	<target name="init" depends="properties">
		<property name="plugindir" value="../org.eclipse.swt"/>
		<property name="bootclasspath" value=""/>
		<taskdef name="swt.jnigen" classname="org.eclipse.swt.tools.internal.SwtJniGen" classpath="./bin;${plugindir}/bin"/>
		
	</target>

	<target name="properties" if="eclipse.running">
		<property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/>
	</target>
		
	<!-- Convert SWT 32 bit java source to 64 bit  -->
	<target name="swt.64" depends="init">
		<replace dir="${plugindir}" includes="**/*.java" token="int /*long*/" value="long /*int*/"/>
	</target>
	
	<!-- Convert SWT 64 bit java source to 32 bit  -->
	<target name="swt.32" depends="init">
		<swt.replace from="long /*int*/" to="int /*long*/">
			<fileset dir="${plugindir}" includes="**/*.java"/>
		</swt.replace>
	</target>

	<!-- Output the C source code from the org.eclipse.swt project  -->
	<target name="swt.jnigen" depends="init">
		<!-- generate the C code from the (64 bit) SWT PI java classes -->
		<!-- assumes the org.eclipse.swt project has been built and contain the 64 bit java classes  -->
		<swt.jnigen mainclass="org.eclipse.swt.internal.gtk.OS" classpath="${basedir}/${plugindir}/bin" outputdir="${basedir}/${plugindir}/Eclipse SWT PI/gtk/library/"/>
		<swt.jnigen mainclass="org.eclipse.swt.internal.accessibility.gtk.ATK" classpath="${basedir}/${plugindir}/bin" outputdir="${basedir}/${plugindir}/Eclipse SWT PI/gtk/library/"/>
		<swt.jnigen mainclass="org.eclipse.swt.internal.gnome.GNOME" classpath="${basedir}/${plugindir}/bin" outputdir="${basedir}/${plugindir}/Eclipse SWT PI/gtk/library/"/>
	</target>

</project>